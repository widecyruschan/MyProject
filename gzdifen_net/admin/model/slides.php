<?phpout();$id=verify_id($_GET['id']);$column=verify_id($_POST['column']);$title=str_check($_POST['title']);$pic=str_check($_POST['pic']);$thumbnail=str_check($_POST['thumbnail']);$url=str_check($_POST['url']);$permute=str_check($_POST['permute']);$note=str_check($_POST['note']);$ids=str_check($_POST['ids']);if($action=='edit_column'){$db->query( "UPDATE  `{$DB_dbprefix}slides_columns` SET  `title` =  '$title',`note` =  '$note' WHERE  `id` =$id; ");addlog( "修改幻灯栏目$id",$_SESSION['admin_user']);done('修改成功','navNewsLi','closeCurrent');}if($action=='del_column'){$db->query( "DELETE FROM {$DB_dbprefix}slides_columns WHERE id=$id; ");addlog( "删除幻灯$id",$_SESSION['admin_user']);done('删除成功','navNewsLi','closeCurrent');}if($action=='add'){$db->query( "INSERT INTO `{$DB_dbprefix}slides` (`id`, `title`, `cid`, `thumbnail`, `pic`, `permute`, `url`) VALUES (NULL, '$title', '$column', '$thumbnail', '$pic', '$permute', '$url');");addlog( "添加幻灯片",$_SESSION['admin_user']);done('操作成功','navNewsLi','closeCurrent');}if($action=='edit'){$db->query( "UPDATE  `{$DB_dbprefix}slides` SET  `title` =  '$title',`cid` =  '$column',`thumbnail` =  '$thumbnail',`pic` =  '$pic',`permute` = '$permute',`url` =  '$url' WHERE  `id` =$id;");addlog( "修改幻灯片",$_SESSION['admin_user']);done('操作成功','navNewsLi','closeCurrent');}if($action=='alldel'){$db->query("DELETE  FROM  `{$DB_dbprefix}slides` WHERE  `id` in ($ids) ");addlog( "批量删除幻灯片",$_SESSION['admin_user']);done('修改成功','','');exit();}if($action=='del'){$db->query( "DELETE FROM {$DB_dbprefix}slides WHERE id=$id; ");addlog( "删除幻灯$id",$_SESSION['admin_user']);done('删除成功','','');}if($action=='add_column'){$db->query( "INSERT INTO  `{$DB_dbprefix}slides_columns` (`title`,`note`)VALUES ('$title','$note');");addlog( "添加幻灯片栏目",$_SESSION['admin_user']);done('操作成功','navNewsLi','closeCurrent');}?>