<?phpout();$id=verify_id($_GET['id']);$column=verify_id($_GET['column']);if($action=="edit_column"){$db->query( "select * from {$DB_dbprefix}slides_columns WHERE id=$id ");if ($db->next_record()){$id=$db->Record['id'];$title=$db->Record['title'];$note=$db->Record['note'];}}if($action=="edit_columns"){$strSql="SELECT * FROM  `{$DB_dbprefix}slides_columns`   ORDER BY  `id` ";$db->query( $strSql );while ($db->next_record()){$stride_column=stride('title','slides_columns','id',$db->Record['cid']);$PHPCMS_slides .= "<tr target=\"id\" rel=\"".$db->Record['id']."\">					<td>".$db->Record['id']."</td>					<td>".$db->Record['title']."</td>                    <td>".$db->Record['note']."</td>                    <td><a class=\"delete\" href=\"?model=slides&action=del_column&id=".$db->Record['id']."\" target=\"ajaxTodo\" title=\"确定要删除吗?\"><span>删除</span></a>　<a href=\"?controller=slides&action=edit_column&id=".$db->Record['id']."\" target=\"dialog\" ><span>修改</span></a></td>				    </tr>";}}if($action=="add"){$db->query( "select * from {$DB_dbprefix}slides_columns");while ($db->next_record()){$columns.="<option value=\"".$db->Record['id']."\">".$db->Record['title']."</option>";}}if($action=="edit"){verify_null($id,'id');$db->query( "select * from {$DB_dbprefix}slides WHERE id=$id ");if ($db->next_record()){$id=$db->Record['id'];$title=$db->Record['title'];$column=$db->Record['cid'];$thumbnail=$db->Record['thumbnail'];$pic=$db->Record['pic'];$permute=$db->Record['permute'];$url=$db->Record['url'];}$db->query( "select * from {$DB_dbprefix}slides_columns");while ($db->next_record()){$columns.="<option value=\"".$db->Record['id']."\"";if($db->Record['id']==$column){$columns.=" selected";}$columns.=">".$db->Record['title']."</option>";}}$strSql= "SELECT * FROM  `{$DB_dbprefix}slides_columns`";$db->query( $strSql );while ($db->next_record()){$slides_columns .= "<li><a target='navTab' href='?controller=slides&column=".$db->Record['id']."'>".$db->Record['title']."</a></li>";}if($action==""){if($_POST['numPerPage']==""){$numPerPage=20;}else{$numPerPage=$_POST['numPerPage'];}if($_POST['pageNum']==""){$pageNum=1;}else{$pageNum=$_POST['pageNum'];}if($pageNum==0){$offset = 1;}else{$offset = ( $pageNum -1 ) * $numPerPage;}if($column!=""){$where="WHERE `column`=$column";}$execc = "SELECT id FROM  `{$DB_dbprefix}slides` $where";$strSql="SELECT * FROM  `{$DB_dbprefix}slides` $where  ORDER BY  `permute` DESC,`id` DESC  LIMIT {$offset},{$numPerPage}";$resultc = mysql_query( $execc );$intNum = mysql_num_rows( $resultc );$db->query( $strSql );while ($db->next_record()){$stride_column=stride('title','slides_columns','id',$db->Record['cid']);$PHPCMS_slides .= "<tr target=\"id\" rel=\"".$db->Record['id']."\">			        <td><input name=\"ids\" value=\"".$db->Record['id']."\" type=\"checkbox\"></td>					<td>".$db->Record['id']."</td>					<td>".$stride_column."</td>					<td>".$db->Record['title']."</td>                    <td>".$db->Record['pic']."</td>                    <td>".$db->Record['permute']."</td>				    </tr>";}}?>