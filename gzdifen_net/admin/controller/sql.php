<?phpout();if($action!="edit"){$query =mysql_query("SHOW TABLES");while ($rt = mysql_fetch_array($query)){$value = trim(current($rt));$othortable[]=$value;}}else{$filedb=array();$handle=opendir('backup');while($file = readdir($handle)){if((!$dbtablepre ||preg_match("/^PHPCMS_/i",$file) ||preg_match("/^$dbtablepre/i",$file)) &&preg_match("/\.sql$/i",$file)){$strlen=preg_match("/^$dbtablepre/i",$file) ?16 +strlen($dbtablepre) : 19;$fp=fopen("backup/$file",'rb');$bakinfo=fread($fp,200);fclose($fp);$detail=explode("\n",$bakinfo);$bk['name']=$file;$bk['version']=substr($detail[2],10);$bk['time']=substr($detail[3],8);$bk['file']=substr($file,0,20);$bk['pre']=substr($file,0,$strlen);$bk['num']=substr($file,$strlen,strrpos($file,'.')-$strlen);$filedb[]=$bk;}}}function SafeFunc(){}function getdirname($path){if(strpos($path,'\\')!==false){return substr($path,0,strrpos($path,'\\'));}elseif(strpos($path,'/')!==false){return substr($path,0,strrpos($path,'/'));}else{return '/';}}?>