<?phpout();$id=verify_id($_GET['id']);if(isset($action)){$sql = "select * from `{$DB_dbprefix}columns` order by permute desc,id asc";$query = $db ->query($sql);while($row=mysql_fetch_assoc($query)){$columns_arr[] = array($row['id'],$row['title'],$row['bid']);}}function module_select($id){global $db,$DB_dbprefix;echo  "<option value=\"url\"";if($id=="url"){echo " selected=\"selected\" ";}echo ">跳转[系统模块]</option>";echo  "<option value=\"singlepage\"";if($id=="singlepage"){echo " selected=\"selected\" ";}echo ">单页[系统模块]</option>";if(isset($id)){$where="WHERE id=$id";}$sql = "select * from `{$DB_dbprefix}module`  order by id asc";$query = $db ->query($sql);while($row=mysql_fetch_assoc($query)){echo "<option value=\"".$row['id']."\"";if($id==$row['id']){echo " selected=\"selected\" ";}echo ">".$row['name']."</option>";}}function columns_select($m,$id,$index){global $columns_arr;$n = str_pad('',$m,'-',STR_PAD_RIGHT);$n = str_replace("-","&nbsp;&nbsp;",$n);for($i=0;$i<count($columns_arr);$i++){if($columns_arr[$i][2]==$id){if($columns_arr[$i][0]==$index){echo "        <option value=\"".$columns_arr[$i][0]."\" selected=\"selected\">".$n."|--".$columns_arr[$i][1]."</option>";}else{echo "        <option value=\"".$columns_arr[$i][0]."\">".$n."|--".$columns_arr[$i][1]."</option>";}columns_select($m+1,$columns_arr[$i][0],$index);}}}if($action=='edit'){$db->query( "select * from {$DB_dbprefix}columns WHERE id=$id ");if ($db->next_record()){$id=$db->Record['id'];$title=$db->Record['title'];$bid=$db->Record['bid'];$subtitle=$db->Record['subtitle'];$hide=$db->Record['hide'];$module=$db->Record['module'];$templates=$db->Record['templates'];$description=$db->Record['description'];$keywords=$db->Record['keywords'];$permute=$db->Record['permute'];}}if($action=='add'){}if(!isset($action)){$province=str_check($_POST['province']);$sql = "select * from `{$DB_dbprefix}columns` $where order by permute desc,id asc";$query = $db ->query($sql);while($row=mysql_fetch_assoc($query)){$columns_arr[] = array($row['id'],$row['title'],$row['bid'],$row['time'],$row['hide'],$row['module'],$row['permute'],$row['hide']);}function lmfl($m,$id,$index){global $columns_arr;$n = str_pad('',$m,'-',STR_PAD_RIGHT);$n = str_replace("-","　　　　　",$n);for($i=0;$i<count($columns_arr);$i++){if($columns_arr[$i][2]==$id){if($columns_arr[$i][0]==$index){echo "        <tr target=\"id\" rel=\"".$columns_arr[$i][0]."\"> <td>".$columns_arr[$i][0]."</td> <td>".$n."|--".$columns_arr[$i][1]."</td><td>";if($columns_arr[$i][7]=="1"){echo "<font color=\"#FF0000\">隐藏</font>";}else{echo "<font color=\"#009900\">显示</font>";}echo "</td><td>";if ($columns_arr[$i][5]=="url"){echo "跳转[系统模块]";}else if($columns_arr[$i][5]=="singlepage"){echo "单页[系统模块]";}else{echo stride('name','module','id',$columns_arr[$i][5]);}echo "</td><td>".date('Y-m-d H:i:s',$columns_arr[$i][3])."</td><td>".$columns_arr[$i][6]."</td></tr>";}else{echo "        <tr  target=\"id\" rel=\"".$columns_arr[$i][0]."\"> <td>".$columns_arr[$i][0]."</td> <td>".$n."|--".$columns_arr[$i][1]."</td><td>";if($columns_arr[$i][7]=="1"){echo "<font color=\"#FF0000\">隐藏</font>";}else{echo "<font color=\"#009900\">显示</font>";}echo "</td><td>";if ($columns_arr[$i][5]=="url"){echo "跳转[系统模块]";}else if($columns_arr[$i][5]=="singlepage"){echo "单页[系统模块]";}else{echo stride('name','module','id',$columns_arr[$i][5]);}echo "</td><td>".date('Y-m-d H:i:s',$columns_arr[$i][3])."</td><td>".$columns_arr[$i][6]."</td></tr>";}lmfl($m+1,$columns_arr[$i][0],$index);}}}}?>