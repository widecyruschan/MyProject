<?phpfunction out($out=null){}function verify_action($action){if($action!=""){$arr=array("add","edit","del","add_column","edit_column","edit_columns","del_column","alldel");if(in_array($action,$arr)){return $action;}else{die('提交的参数非法!');}}}function verify_controller($controller){if($controller!=""){$arr=array("index","login","admin","changepwd","columns","configuration","content","upload","links","log","module","skin","slides","sql","templates","upgrade","view","cache","html");if(in_array($controller,$arr)){return $controller;}else{die('提交的参数非法!');}}}function verify_model($model){if($model!=""){$arr=array("admin","changepwd","columns","configuration","content","links","log","login","module","skin","slides","upload","sql","templates","cache","html");if(in_array($model,$arr)){return $model;}else{die('提交的参数非法!');}}}function admin_permissions($controller){global $admin_permissions;if(!in_array($controller,$admin_permissions)){die('权限不足!');}}function admin_permissions_view($controller,$text){global $admin_permissions;if(in_array($controller,$admin_permissions)){echo $text;}}function admin_login($user,$hits){if(!$user){header("Location:?controller=login");exit();}elseif(!$hits){header("Location:?controller=login");exit();}}function inject_check($sql_str) {return preg_match('/select|insert|update|delete|\'|\/\*|\*|\.\.\/|\.\/|union|into|load_file|outfile/i',$sql_str);}function verify_id($id=null) {if($id){if (inject_check($id)) {exit('提交的参数非法！');}elseif (!is_numeric($id)) {exit('提交的参数非法！');}$id = intval($id);}return $id;}function verify_null($null,$text) {if($null==""){exit($text.'不能为空');}else{return $null;}}function str_check( $str ) {$str = str_replace("%","\%",$str);return $str;}function post_check($post) {if (!get_magic_quotes_gpc()) {$post = addslashes($post);}$post = str_replace("_","\_",$post);$post = str_replace("%","\%",$post);$post = nl2br($post);$post = htmlspecialchars($post);return $post;}?>