<?phprequire_once(dirname(__FILE__).'/header.php');require_once(CMSINC.'/config/picture.config.php');$mycms['module'] = module::get_module(1);if(isset($_POST['watermark'])){	$pics_cfg = $_POST;	foreach($mycms['module'] as $m){		foreach ($pics_cfg[$m['modcode']] as &$n){			$n[0] = $n[0] == 1 ? 1 : 0;			$n[1] = $n[1] < 10 ? 10 : $n[1];			$n[2] = $n[2] < 10 ? 10 : $n[2];			$n[3] = $n[3] == 1 ? 1 : 0;			ksort($n); 		}	}	is_numeric($pics_cfg['cut']['conditions'][0]) or $pics_cfg['cut']['conditions'][0] = 0;	is_numeric($pics_cfg['cut']['conditions'][1]) or $pics_cfg['cut']['conditions'][1] = 0;	is_numeric($pics_cfg['watermark']['request'][0]) or $pics_cfg['watermark']['request'][0] = 0;	is_numeric($pics_cfg['watermark']['request'][1]) or $pics_cfg['watermark']['request'][1] = 0;	is_numeric($pics_cfg['watermark']['x']) or $pics_cfg['watermark']['x'] = 0;	is_numeric($pics_cfg['watermark']['y']) or $pics_cfg['watermark']['y'] = 0;	is_numeric($pics_cfg['watermark']['size']) or $pics_cfg['watermark']['size'] = 20;	is_numeric($pics_cfg['watermark']['angle']) or $pics_cfg['watermark']['angle'] = 0;	substr($pics_cfg['watermark']['pics'],0,3) == '../' or $pics_cfg['watermark']['pics'] = '../'.$pics_cfg['watermark']['pics'];	$pics_cfg['watermark']['truetype'] = '../inc/fonts/'.$pics_cfg['watermark']['truetype'];	if(array2php($pics_cfg,'picture_config',CMSINC.'/config/picture.config.php')){		admin::logs(3,$language['page']['update_page']."({$language['common']['successful']})"); 		msgbox($language['common']['successful'],'CURRENT');	} else {		admin::logs(3,$language['page']['update_page']."({$language['common']['failed']})"); 		msgbox($language['page']['failure'],'CURRENT'); 	}	}$mycms['picture_config'] = $picture_config; $mycms['gd_info'] = (function_exists("gd_info") && extension_loaded('gd')) ? gd_info() : NULL; $ttf_dir = CMSINC.'/fonts/';$ttf_files = scan_dir($ttf_dir);$mycms['ttf_files'] = array();foreach($ttf_files as $n){	$ns = $ttf_dir.$n;	if(is_file($ns) && strtolower(pathinfo($ns,PATHINFO_EXTENSION)) == 'ttf'){		$mycms['ttf_files'][] = $n;	}}$mycms['preview_failed'] = 1;$mycms['watermark_preview'] = '../inc/tmp/other/watermark_preview.jpg';$pics = new picture();$pics->watermark['file'] = '../inc/images/watermark_preview_bg.jpg';$pics->watermark['rename'] = $mycms['watermark_preview'];if($pics->watermark() === false) $mycms['preview_failed'] = $pics->info;	require_once(ADMIN_PATH.'/footer.php'); 