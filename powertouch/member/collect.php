<?phpinclude( "./inc/header.php" );include_once( "../inc/class.page.php" );login_check();//收藏if($_GET['Action']=='collect'){	global $db,$uid;	$id=verify_id($_GET['id']);	$db->query( "INSERT INTO {$DB_dbprefix}member_collect (`uid` ,`cid` ,`addtime` )VALUES ({$tun2_id}, {$id}, '".date("Y-m-d H:i:s")."');");	echo "收藏成功";	/*echo '<script language=javascript>alert(\'收藏成功!\');history.go(-1)</script>';*/	exit();}//删除if($_GET['Action']=='del'){	global $db,$uid;	$id=verify_id($_GET['id']);	$db->query( "DELETE FROM {$DB_dbprefix}member_collect WHERE uid=".$tun2_id." and cid=".$id );	echo '<script language=javascript>alert(\'删除收藏成功!\');history.go(-1)</script>';	exit();}function collect($num,$Sorting,$Sequence){	global $db,$page,$keyword,$Type,$intPerpage,$execc,$upfile,$webdir,$uid,$DB_dbprefix,$tun2_id;	$intPerpage=$num;    if (isset($page)) {        $offset = ($page -1)*$num;    }    else {        $offset = 0;    }	$strSql="SELECT * FROM {$DB_dbprefix}member_collect WHERE  uid=$tun2_id";	$execc="SELECT id FROM {$DB_dbprefix}member_collect WHERE  uid=$tun2_id";	switch ($Sorting){	case 1:		$strSql.=" Order by id";	break;	case 2:		$strSql.=" Order by addtime";	break;	case 3:		$strSql.=" Order by cid";	break;	}	switch ($Sequence){	case 1:		$strSql.=" desc";	break;	case 2:		$strSql.=" asc";	break;	}	$strSql.=" limit $offset,$num";	$db->query($strSql);	$tun2_array = array();	$i=0;		while($db->next_record())			{			$tun2_array[]       = array(                'id' 	        => $db->Record["cid"],				'actor' 	    => str_replace("|"," ",$db->Record["actor"]),				'user' 	        => namezh("{$DB_dbprefix}member","user",$db->Record["uid"]),				'title' 	    => namezh("{$DB_dbprefix}content","title",$db->Record["cid"]),				'content' 	    => namezh("{$DB_dbprefix}content","content",$db->Record["cid"]),				'photo'		    => tun2pic(namezh("{$DB_dbprefix}content","photo",$db->Record["cid"])),				'date' 	        => namezh("{$DB_dbprefix}content","addtime",$db->Record["cid"]),				'hits'      	=> namezh("{$DB_dbprefix}content","hits",$db->Record["cid"]),				'num'			=> $i+=1,				'url' 		    => tun2link($db->Record["cid"],$db->Record["addtime"]),				'addtime' 	    => $db->Record["addtime"],				'del'           => $webdir."member/collect.php?Action=del&id=".$db->Record["cid"],			);			}	return $tun2_array;	unset($tun2_array);}$location = location( "collect","" );define("IN", TRUE);$tpl_refresh_time = $skincache;$tpl_default_dir = "../templates/".$skindir."/member";$t = new template();$t->tpl_default_dir = $tpl_default_dir;$t->tpl_refresh_time = $tpl_refresh_time;$page = verify_id( $_GET['PB_page'] );$uid = $tun2_id;include($t->tpl("collect"));?>